var z=Object.defineProperty;var P=(i,o,l)=>o in i?z(i,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[o]=l;var y=(i,o,l)=>(P(i,typeof o!="symbol"?o+"":o,l),l);import{p as B,g as q}from"./axios.e9d7530e.js";import{C as I}from"./Card.8d47b4a0.js";import{d as F,u as S,r as C,a as E,o as g,c as d,F as w,b as k,n as U,e as c,t as v,_ as f,U as D,f as R,g as T,w as j,h as V,i as K,j as p,m as M}from"./index.5263889d.js";import{G as Q}from"./GxlApiService.775ae55c.js";import"./axios.1cbd2f54.js";const W={class:"card"},J=["onClick"],O=["src"],X={class:"name"},Y=F({__name:"HotCard",emits:["acitve-success"],setup(i,{emit:o}){S();const l=C(0),s=E({list:[{name:"\u6700\u8FD1\u4E0A\u65B0",value:1,img:"New.png"},{name:"\u70ED\u5EA6\u6E38\u620F",value:1,img:"Popular.png"},{name:"\u6211\u7684\u5173\u6CE8",value:1,img:"Following.png"}],handleActive:n=>{l.value=n,o("acitve-success",n)}});return(n,a)=>(g(),d("div",W,[(g(!0),d(w,null,k(s.list,(r,_)=>(g(),d("div",{key:_,class:U(["list",l.value===_?"active":""]),onClick:h=>s.handleActive(_)},[c("img",{src:n.$filters.prefix(r.img)},null,8,O),c("span",X,v(r.name),1)],10,J))),128))]))}});const Z=f(Y,[["__scopeId","data-v-0c6be14e"]]),ee={class:"card"},ae={class:"ptitle"},te=["onClick"],se=["src"],oe={class:"title"},ne={style:{"text-align":"center"},class:"name"},le=F({__name:"CategoryListCard",props:{title:{type:String,default:""},list:{type:Array,default:[]}},setup(i){const o=i,l=S();E({list:[{name:"\u6700\u8FD1\u4E0A\u65B0",value:1,img:"New.png"},{name:"\u70ED\u5EA6\u6E38\u620F",value:1,img:"Popular.png"},{name:"\u6211\u7684\u5173\u6CE8",value:1,img:"Following.png"}]});function s(n){l.push("/category/"+n)}return(n,a)=>(g(),d("div",ee,[c("div",ae,v(o.title),1),(g(!0),d(w,null,k(i.list,(r,_)=>(g(),d("div",{key:_,class:"list",onClick:h=>s(r.name)},[c("img",{style:{width:"40px",height:"40px","border-radius":"8px"},src:n.$filters.prefix(r.img)},null,8,se),c("div",oe,[c("div",ne,v(r.name),1)])],8,te))),128))]))}});const ue=f(le,[["__scopeId","data-v-6d177bde"]]),ce={class:"card"},ie={class:"ptitle"},re=["onClick"],ge=["src"],de={class:"title"},_e={style:{display:"block",width:"100%"},class:"name"},me={class:"zhaiyao"},pe=F({__name:"RecommentCard",props:{title:{type:String,default:""},list:{type:Array,default:[]}},setup(i){const o=i,l=S();E({list:[{name:"\u6700\u8FD1\u4E0A\u65B0",value:1,img:"New.png"},{name:"\u70ED\u5EA6\u6E38\u620F",value:1,img:"Popular.png"},{name:"\u6211\u7684\u5173\u6CE8",value:1,img:"Following.png"}]});function s(n){l.push("/detail/"+n.toString())}return(n,a)=>(g(),d("div",ce,[c("div",ie,v(o.title),1),(g(!0),d(w,null,k(i.list,(r,_)=>(g(),d("div",{key:_,class:"list",onClick:h=>s(r.id)},[c("img",{style:{width:"40px",height:"40px","border-radius":"18px"},src:r.image_url},null,8,ge),c("div",de,[c("div",_e,v(r.title),1),c("div",me,v(r.game_name),1)])],8,re))),128))]))}});const x=f(pe,[["__scopeId","data-v-3aed7832"]]),ve={class:"container"},he={style:{display:"grid","grid-template-rows":"260px repeat(1,1fr)","row-gap":"20px"}},ye={style:{display:"flex"},class:"pagination-container"},Ce={style:{display:"grid","grid-template-rows":"repeat(2,1fr)","row-gap":"20px"}},Fe=F({__name:"Home",setup(i){C(0);const o=C(1),l={page_indices:1,page_num:5},s=C({page_indices:1,page_num:5}),n=C(0),a=E({list:[],category:[],recommentList:[{name:"\u523A\u6FC0\u6218\u573A",value:"\u771F\u5B9E\u523A\u6FC0,\u5929\u964D\u5947\u5175",img:"New.png"},{name:"\u70ED\u5EA6\u6E38\u620F",value:1,img:"Popular.png"},{name:"\u6211\u7684\u5173\u6CE8",value:1,img:"Following.png"}],qualityList:[{name:"\u8FD9\u91CC\u662F\u6E38\u620F\u52A8\u6001\u7684\u6807\u9898",value:1,describe:"\u6E38\u620F\u5B98\u65B9",img:"Frame.png"},{name:"\u70ED\u5EA6\u6E38\u620F",value:1,describe:"\u6E38\u620F\u5B98\u65B9",img:"Frame.png"},{name:"\u6211\u7684\u5173\u6CE8",value:1,describe:"\u6E38\u620F\u5B98\u65B9",img:"Frame.png"}],gameDynamic:[{name:"\u523A\u6FC0\u6218\u573A",value:1,describe:"\u6E38\u620F\u5B98\u65B9",img:"Frame.png"},{name:"\u70ED\u5EA6\u6E38\u620F",value:1,describe:"\u6E38\u620F\u5B98\u65B9",img:"Frame.png"},{name:"\u6211\u7684\u5173\u6CE8",value:1,describe:"\u6E38\u620F\u5B98\u65B9",img:"Frame.png"}],hotList:[],tabClick:(e,t)=>{switch(e.props.name){case 0:a.reqHotgame();break;case 1:a.reqFollowedGame();break;case 2:a.reqNewGame();break}},reqHotgame:()=>{B("/api/home/all/2",s.value).then(e=>{o.value=2;const{records:t,all_num:u}=e;a.list=t,n.value=u}).catch(e=>{console.log(e)})},reqNewGame:()=>{o.value=1,console.log("reqNewGame"),B("api/home/all/1",s.value).then(e=>{const{records:t,all_num:u}=e;console.log("\u65B0\u6E38\u620F",e),a.list=t,n.value=u}).catch(e=>{console.log(e)})},reqFollowedGame:()=>{if(!D.ifExistUser())return;o.value=3;const e=D.getUserInfo();B(`/likes/getAll/${e.username}/`,s.value).then(t=>{const{records:u,all_num:m}=t;a.list=u,n.value=m}).catch(t=>{console.log(t)})},onCategoryAll:()=>{console.log("onCategoryAll"),q("/category/all").then(e=>{console.log(e),e.forEach(t=>{t.img="Frame.png",t.name=t.categoryName}),a.category=e,console.log("homeState.category :"),console.log(a.category)})},reqTodayHot:()=>{console.log("reqTodayHot:------------"),q("/post/postingPage/"+5 .toString()).then(t=>{console.log(t),console.log("reqTodayHot:------------end"),a.recommentList=t})},reqHot(){console.log("reqHot:------------"),q("/api/home/hotgame/"+5 .toString()).then(t=>{console.log(t),console.log("reqHot:------------end"),a.hotList=t})},handleActiveSuccess:e=>{switch(console.log(e),s.value.page_num=l.page_num,s.value.page_indices=l.page_indices,e){case 0:a.reqNewGame();break;case 1:a.reqHotgame();break;case 2:console.log("\u8FDB\u884C\u6211\u7684\u5173\u6CE8"),a.reqFollowedGame();break}}}),r=e=>{console.log("handleSizeChange"),s.value.page_num=e,h()},_=e=>{console.log("handleCurrentPageChange"),s.value.page_indices=e,h()};function h(){switch(o.value){case 1:a.reqNewGame();break;case 2:a.reqHotgame();break;case 3:a.reqFollowedGame();break;case 4:$();break}}class H{constructor(t,u){y(this,"keyword");y(this,"category");this.keyword=t,this.category=u}}class N{constructor(t,u){y(this,"page_indices");y(this,"page_num");this.page_indices=t,this.page_num=u}}function $(){const{key_word:e,category:t}={key_word:A.state.key_word,category:A.state.category},u=new N(s.value.page_indices,s.value.page_num),m=new H(e,t);G(u,m)}const G=(e,t)=>{Q.postWithConfig("/api/search",e,{params:{key_word:t.keyword,category:t.category,sort:0}}).then(u=>{if(u.data!=null){const{records:m,all_num:b}=u.data;a.list=m,n.value=b}else a.list=[],n.value=0})},A=R(),L=T(()=>A.state.isSearch);return j(L,(e,t)=>{console.log("watching!!!!!!!!!!!!!!!!!!!!!!!!!!!",e,t),M(["key_word","category"]),s.value.page_num=l.page_num,s.value.page_indices=l.page_indices,$(),o.value=4}),V(()=>{a.reqNewGame(),a.onCategoryAll(),a.reqTodayHot(),a.reqHot()}),(e,t)=>{const u=K("el-pagination");return g(),d("div",ve,[c("div",he,[p(Z,{onAcitveSuccess:a.handleActiveSuccess},null,8,["onAcitveSuccess"]),p(ue,{list:a.category,title:"\u6E38\u620F\u7C7B\u578B"},null,8,["list"])]),c("div",null,[(g(!0),d(w,null,k(a.list,(m,b)=>(g(),d("div",{key:b},[p(I,{record:m,class:"u-m-b-30"},null,8,["record"])]))),128)),c("div",ye,[p(u,{class:"pagination",background:!0,"current-page":s.value.page_indices,"page-sizes":[2,4,8,12,16,20],"page-size":s.value.page_num,total:n.value,onSizeChange:r,onCurrentChange:_,layout:"total, sizes, prev, pager, next, jumper"},null,8,["current-page","page-size","total"])])]),c("div",Ce,[p(x,{list:a.recommentList,title:"\u6BCF\u65E5\u63A8\u8350"},null,8,["list"]),p(x,{list:a.hotList,title:"\u4F18\u8D28\u795E\u8D34"},null,8,["list"])])])}}});const Be=f(Fe,[["__scopeId","data-v-d801ada8"]]);export{Be as default};
