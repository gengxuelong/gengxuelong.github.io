import{g as C,p as k}from"./axios.bb0bbe53.js";import{U as r,E as m,_ as x,i as n,c as y,e as o,j as e,k as l,o as N,t as c,l as f,A as U,B as I}from"./index.08aa9827.js";import"./axios.1cbd2f54.js";const w={data(){return{username:"",data:{},dialog:{visible:!1,user_nickname:""}}},mounted(){const t=r.getUserInfo();r.isNotNullOrEmptyOrUndefined(t)&&(this.username=t.username),C(`/api/personal/userinfo/${this.username}`).then(a=>{this.data=a,r.setUserInfo(a),console.log("myhome mounted",a)}).catch(a=>{console.log(a)})},computed:{imageShow(){return this.data.image_url?this.data.image_url:"https://img-bsy.txrpic.com/Element/00/88/63/12/549f4792_E886312_4b2c4691XZ.png?imageMogr2/quality/90/thumbnail/320x%3E"}},methods:{uploadAndSetImage(t){const a=new FormData;a.append("multipartFile",t),k("/image/upload",a).then(d=>{console.log("res",d);const _=d.link;console.log(_),k("/image/setUserImage",{image_url:_,username:this.username}).then(s=>{this.data.image_url=_,m.success("\u5934\u50CF\u4FEE\u6539\u6210\u529F"),r.setUserInfo(this.data),window.location.reload()}).catch(s=>{m.error(s.message)})}).catch(d=>{m.error(d.message)})},handleUploadClick(){const t=document.createElement("input");t.type="file",t.accept="image/*",t.addEventListener("change",()=>{const a=t.files[0];a&&this.uploadAndSetImage(a)}),t.click()},handleNickNameClick(){console.log("anniubeidianjile"),this.dialog.visible=!0,this.dialog.user_nickname=this.data.user_nickname},handleNickNameConfirm(){k("/api/update/nick",{username:this.username,user_nickname:this.dialog.user_nickname}).then(t=>{this.data.user_nickname=this.dialog.user_nickname,this.dialog.visible=!1,m.success("\u6635\u79F0\u4FEE\u6539\u6210\u529F"),r.setUserInfo(this.data),window.location.reload()}).catch(t=>{m.error(t.message)})}}};const B=t=>(U("data-v-aed89055"),t=t(),I(),t),V={class:"box-card"},S=B(()=>o("div",{class:"header clearfix"}," \u7528\u6237\u4FE1\u606F ",-1)),A={class:"item"},D={class:"profile-info"},M={class:"text"},j={class:"text"},H={class:"text"},O={class:"text"},q={class:"text"},z={class:"text"},L={class:"profile-image"},T={class:"image"};function X(t,a,d,_,s,p){const i=n("el-divider"),u=n("el-form-item"),h=n("el-button"),v=n("el-form"),b=n("el-avatar"),E=n("el-input"),F=n("el-dialog");return N(),y("div",null,[o("div",V,[S,o("div",A,[o("div",D,[e(v,{"label-width":"80px"},{default:l(()=>[e(i),e(u,{label:"\u7528\u6237\u540D"},{default:l(()=>[o("span",M,c(s.data.username),1)]),_:1}),e(i),e(u,{label:"\u6635\u79F0"},{default:l(()=>[o("span",j,c(s.data.user_nickname),1)]),_:1}),e(h,{class:"el-button btn-prev nickname",onClick:p.handleNickNameClick},{default:l(()=>[f("\u4FEE\u6539\u6635\u79F0")]),_:1},8,["onClick"]),e(i),e(u,{label:"\u79EF\u5206"},{default:l(()=>[o("span",H,c(s.data.user_points),1)]),_:1}),e(i),e(u,{label:"\u72B6\u6001"},{default:l(()=>[o("span",O,c(s.data.user_status),1)]),_:1}),e(i),e(u,{label:"\u8EAB\u4EFD"},{default:l(()=>[o("span",q,c(s.data.user_identity===0?"\u666E\u901A\u7528\u6237":"\u7BA1\u7406\u5458"),1)]),_:1}),e(i),e(u,{label:"\u6807\u7B7E"},{default:l(()=>[o("span",z,c(s.data.tag),1)]),_:1})]),_:1})]),o("div",L,[o("div",T,[e(b,{size:150,src:p.imageShow},null,8,["src"])]),o("div",null,[e(h,{class:"el-button btn-prev",onClick:p.handleUploadClick},{default:l(()=>[f("\u4FEE\u6539\u5934\u50CF")]),_:1},8,["onClick"])])])])]),e(F,{title:"\u4FEE\u6539\u6635\u79F0",modelValue:s.dialog.visible,"onUpdate:modelValue":a[2]||(a[2]=g=>s.dialog.visible=g),width:"30%"},{default:l(()=>[e(E,{modelValue:s.dialog.user_nickname,"onUpdate:modelValue":a[0]||(a[0]=g=>s.dialog.user_nickname=g),placeholder:"\u8BF7\u8F93\u5165\u65B0\u7684\u6635\u79F0",style:{"margin-bottom":"30px"}},null,8,["modelValue"]),e(h,{onClick:a[1]||(a[1]=g=>s.dialog.visible=!1)},{default:l(()=>[f("Cancel")]),_:1}),e(h,{type:"primary",onClick:p.handleNickNameConfirm},{default:l(()=>[f(" Confirm ")]),_:1},8,["onClick"])]),_:1},8,["modelValue"])])}const K=x(w,[["render",X],["__scopeId","data-v-aed89055"]]);export{K as default};
